# 设计

## 流程: Flow

- 流程是知道其自身目前进行到哪一步了
- 有最少一个 node 所组成的一系列规定操作的集合体

- id
- name
- school_id: 归属于那个学校的

## 流程中的节点

### 节点的属性
- id
- flow_id: 归属的流程
- name: 节点的名称(例如: 拟稿)
- prev_node: 前一个节点 (为 null 则说明它是流程中的第一步)
- next_node: 下一个节点 (为 null 则说明它是流程中最后一步)
- type: 节点的类型 (简单节点: 表示是只有一个入口, 也只有一个出口)
- dynamic: 是否为动态节点 (动态节点: 表示管理该节点的, 不是一个特定的用户, 而是一个职务, 或者多个职务)
- thresh_hold: 该节点被判定为通过的时候, 需要几个人同意后者完成. 默认为 1 个人
- content: 该节点(也可以称之为步骤)的操作说明

### 节点的负责人: Node Handler

与节点之间, 是一对多的关系

- id
- node_id: 归属的节点
- user_id: 关联的用户的 id (可以为空) 这个为静态节点
- organization_id: 关联的组织 (可以为空) 这个为动态节点
- title_id: 组织内的职务 (可以为空) 这个为动态节点

### 节点的处理 Action

对流程中任意一个节点, 都有可能经过多次的反复, 因此也是一对多的关系

- id
- flow_id: 关联的流程
- node_id: 关联的节点
- result: 处理的结果 (通过, 驳回, 等待)
- user_id: 具体执行了这个动作的用户
- content: 处理结果的描述文字

### 节点的处理所关联的附件

对任意的一个处理, 可能都关联 0 -> N 个附件

- id
- action_id: 关联的动作
- media_id:  关联的文件的 id
- media_url: 关联的文件的链接地址

## 流程中的线: Line

- 它是在流程过程中, 方向的定义. 它自身必定关联了 2 个节点
- 任何一个节点, 接下来都可以有 n 个方向
- 任何一个节点, 之前都有可能由 n 的方向汇集而来